import{j as e,T as s}from"./dashboard-89c4d88a.js";import{r as t}from"./react-vendor-29c1c3a2.js";const a=({userTier:a,communications:n})=>{const[i,r]=t.useState("external"),[c,l]=t.useState(""),[o,m]=t.useState(!1),[d,h]=t.useState(null),[u,p]=t.useState("last_hour"),x=s[a],j=t.useMemo((()=>{let e=n;if(x.internalCommunicationAccess||(e=e.filter((e=>"internal"!==e.type))),"all"!==i&&(e=e.filter((e=>e.type===i))),c){const s=c.toLowerCase();e=e.filter((e=>e.message.toLowerCase().includes(s)||e.summary.toLowerCase().includes(s)||e.fromAgent.toLowerCase().includes(s)||e.toAgent.toLowerCase().includes(s)))}return e.sort(((e,s)=>s.timestamp.getTime()-e.timestamp.getTime()))}),[n,i,c,x.internalCommunicationAccess]),g=e=>{switch(e){case"low":return"#10b981";case"medium":return"#f59e0b";case"high":return"#ef4444";case"critical":return"#7c3aed";default:return"#6b7280"}},v=e=>{switch(e){case"coordination":return"🔄";case"external":return"🌐";case"internal":return"🔒";case"error":return"❌";default:return"💬"}};return e.jsxs("div",{className:"agent-communication-feed",children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("h2",{children:"🔊 Agent Communication Feed"}),e.jsxs("div",{className:"header-stats",children:[e.jsxs("span",{children:["Total: ",n.length]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Filtered: ",j.length]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Tier: ",a.toUpperCase()]})]})]}),e.jsxs("div",{className:"feed-controls",children:[e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{children:"Filter by Type:"}),e.jsxs("select",{value:i,onChange:e=>{return s=e.target.value,void r(s);var s},className:"filter-select",children:[e.jsx("option",{value:"all",children:"All Communications"}),e.jsx("option",{value:"external",children:"External"}),e.jsx("option",{value:"coordination",children:"Coordination"}),e.jsx("option",{value:"error",children:"Errors"}),x.internalCommunicationAccess&&e.jsx("option",{value:"internal",children:"Internal"})]})]}),e.jsxs("div",{className:"search-section",children:[e.jsx("label",{children:"Search:"}),e.jsx("input",{type:"text",value:c,onChange:e=>{return s=e.target.value,void l(s);var s},placeholder:"Search messages, agents...",className:"search-input"})]}),e.jsxs("div",{className:"analysis-section",children:[e.jsx("button",{onClick:()=>(async e=>{m(!0),p(e);try{await new Promise((e=>setTimeout(e,2e3)));const s=new Date;switch(e){case"last_hour":s.setHours(s.getHours()-1);break;case"last_day":s.setDate(s.getDate()-1);break;case"last_week":s.setDate(s.getDate()-7)}const t=n.filter((e=>e.timestamp>=s)),i=new Map,r=new Map,c=new Map;t.forEach((e=>{const s=`${e.fromAgent} → ${e.toAgent}`;i.set(s,(i.get(s)||0)+1),r.set(e.type,(r.get(e.type)||0)+1);const t=e.timestamp.getHours();c.set(t,(c.get(t)||0)+1)}));const l=t.length,o=t.filter((e=>"error"===e.type)).length,m=t.filter((e=>"coordination"===e.type)).length,d=l>0?m/l:0,u=[];o/l>.1&&u.push("High error communication rate detected");const p=Array.from(i.entries()).sort(((e,s)=>s[1]-e[1]))[0];p&&p[1]>.3*l&&u.push(`Heavy communication load on ${p[0]}`);const j=[];d<.6&&j.push("Consider optimizing agent coordination protocols"),o>5&&j.push("Investigate and resolve frequent communication errors"),"free"===a&&j.push("Upgrade to Pro tier for better communication monitoring"),x.internalCommunicationAccess||j.push("Upgrade to Enterprise tier for internal communication visibility");const g={count:l,efficiency:d,bottlenecks:u,recommendations:j,patterns:[{type:"frequent_exchange",agents:p?p[0].split(" → "):[],description:`Most active communication: ${p?p[0]:"N/A"}`,impact:"neutral"}]};return h(g),g}catch(s){throw s}finally{m(!1)}})(u),disabled:o,className:"analyze-button",children:o?"🔄 Analyzing...":"📊 Analyze Patterns"}),e.jsxs("select",{value:u,onChange:e=>p(e.target.value),className:"timeframe-select",children:[e.jsx("option",{value:"last_hour",children:"Last Hour"}),e.jsx("option",{value:"last_day",children:"Last Day"}),e.jsx("option",{value:"last_week",children:"Last Week"})]})]})]}),d&&e.jsxs("div",{className:"analysis-results",children:[e.jsx("h3",{children:"📊 Communication Analysis"}),e.jsxs("div",{className:"analysis-grid",children:[e.jsxs("div",{className:"metric",children:[e.jsx("label",{children:"Total Communications:"}),e.jsx("span",{children:d.count})]}),e.jsxs("div",{className:"metric",children:[e.jsx("label",{children:"Efficiency:"}),e.jsxs("span",{style:{color:d.efficiency>.7?"#10b981":"#ef4444"},children:[(100*d.efficiency).toFixed(1),"%"]})]}),e.jsxs("div",{className:"metric",children:[e.jsx("label",{children:"Patterns:"}),e.jsx("span",{children:d.patterns.length})]})]}),d.bottlenecks.length>0&&e.jsxs("div",{className:"bottlenecks",children:[e.jsx("h4",{children:"⚠️ Bottlenecks:"}),e.jsx("ul",{children:d.bottlenecks.map(((s,t)=>e.jsx("li",{children:s},t)))})]}),d.recommendations.length>0&&e.jsxs("div",{className:"recommendations",children:[e.jsx("h4",{children:"💡 Recommendations:"}),e.jsx("ul",{children:d.recommendations.map(((s,t)=>e.jsx("li",{children:s},t)))})]})]}),e.jsx("div",{className:"communications-list",children:0===j.length?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"📭 No communications found for the current filter."}),!x.internalCommunicationAccess&&e.jsx("p",{children:"🔒 Upgrade to Enterprise tier to see internal communications."})]}):j.map(((s,t)=>{return e.jsxs("div",{className:`communication-item ${s.type}`,children:[e.jsx("div",{className:"comm-header",children:e.jsxs("div",{className:"comm-meta",children:[e.jsx("span",{className:"type-icon",children:v(s.type)}),e.jsxs("span",{className:"agents",children:[s.fromAgent," → ",s.toAgent]}),e.jsx("span",{className:"priority",style:{color:g(s.priority)},children:s.priority.toUpperCase()}),e.jsx("span",{className:"timestamp",children:(a=s.timestamp,a.toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}))})]})}),e.jsxs("div",{className:"comm-content",children:[e.jsx("div",{className:"summary",children:s.summary}),e.jsxs("details",{className:"message-details",children:[e.jsx("summary",{children:"View Full Message"}),e.jsx("div",{className:"full-message",children:s.message})]})]}),s.metadata&&Object.keys(s.metadata).length>0&&e.jsx("div",{className:"comm-metadata",children:Object.entries(s.metadata).map((([s,t])=>e.jsxs("span",{className:"metadata-item",children:[s,": ",String(t)]},s)))})]},`${s.fromAgent}-${s.toAgent}-${s.timestamp.getTime()}-${t}`);var a}))}),"free"===a&&e.jsx("div",{className:"tier-notice",children:e.jsx("p",{children:"🔒 Limited to external communications only. Upgrade to Pro for full access."})})]})};export{a as default};
