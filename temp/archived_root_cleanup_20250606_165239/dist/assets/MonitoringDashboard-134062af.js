import{j as e}from"./dashboard-89c4d88a.js";import{r as s}from"./react-vendor-29c1c3a2.js";const r=({userTier:r})=>{const[i,a]=s.useState(null),[c,t]=s.useState([]),[l,n]=s.useState([]),[d,h]=s.useState([]),[o,m]=s.useState(!0),[j,x]=s.useState(!0),[v,N]=s.useState(5e3),u="enterprise"===r,p=s.useCallback((async()=>{if(u)try{const[e,s,i,c]=await Promise.all([fetch("/api/admin/metrics/system",{headers:{"user-tier":r}}),fetch("/api/admin/metrics/endpoints",{headers:{"user-tier":r}}),fetch("/api/admin/metrics/users",{headers:{"user-tier":r}}),fetch("/api/admin/errors/recent",{headers:{"user-tier":r}})]);if(e.ok){const s=await e.json();a(s)}if(s.ok){const e=await s.json();t(e)}if(i.ok){const e=await i.json();n(e)}if(c.ok){const e=await c.json();h(e)}}catch(e){}finally{m(!1)}}),[u,r]);s.useEffect((()=>{p()}),[p]),s.useEffect((()=>{let e;return j&&u&&(e=setInterval(p,v)),()=>{e&&clearInterval(e)}}),[j,v,p,u]);return u?o?e.jsx("div",{className:"monitoring-dashboard",children:e.jsxs("div",{className:"loading",children:[e.jsx("h2",{children:"📊 Loading Monitoring Dashboard..."}),e.jsx("div",{className:"loading-spinner",children:"Fetching system metrics..."})]})}):e.jsxs("div",{className:"monitoring-dashboard",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h2",{children:"📊 System Monitoring Dashboard"}),e.jsxs("div",{className:"dashboard-controls",children:[e.jsxs("label",{className:"refresh-control",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:e=>x(e.target.checked)}),"Auto-refresh"]}),e.jsxs("select",{value:v,onChange:e=>N(Number(e.target.value)),disabled:!j,children:[e.jsx("option",{value:1e3,children:"1s"}),e.jsx("option",{value:5e3,children:"5s"}),e.jsx("option",{value:1e4,children:"10s"}),e.jsx("option",{value:3e4,children:"30s"})]}),e.jsx("button",{onClick:p,className:"refresh-button",children:"🔄 Refresh Now"})]})]}),i&&e.jsxs("div",{className:"metrics-section",children:[e.jsx("h3",{children:"System Overview"}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"⏱️"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("h4",{children:"Uptime"}),e.jsx("div",{className:"metric-value",children:(g=i.uptime,`${Math.floor(g/86400)}d ${Math.floor(g%86400/3600)}h ${Math.floor(g%3600/60)}m`)})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"📈"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("h4",{children:"Total Requests"}),e.jsx("div",{className:"metric-value",children:i.totalRequests.toLocaleString()})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"❌"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("h4",{children:"Error Rate"}),e.jsxs("div",{className:"metric-value",children:[i.errorRate.toFixed(2),"%"]})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"⚡"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("h4",{children:"Avg Response Time"}),e.jsxs("div",{className:"metric-value",children:[i.responseTime,"ms"]})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"🔗"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("h4",{children:"Active Connections"}),e.jsx("div",{className:"metric-value",children:i.activeConnections})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"💾"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("h4",{children:"Memory Usage"}),e.jsx("div",{className:"metric-value",children:(e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,s)*100)/100} ${["Bytes","KB","MB","GB"][s]}`})(i.memoryUsage)})]})]})]})]}),e.jsxs("div",{className:"metrics-section",children:[e.jsx("h3",{children:"API Endpoint Analytics"}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"metrics-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Endpoint"}),e.jsx("th",{children:"Requests"}),e.jsx("th",{children:"Avg Response Time"}),e.jsx("th",{children:"Errors"}),e.jsx("th",{children:"Last Accessed"})]})}),e.jsx("tbody",{children:c.map(((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"endpoint-path",children:s.endpoint}),e.jsx("td",{children:s.requests.toLocaleString()}),e.jsxs("td",{children:[s.avgResponseTime,"ms"]}),e.jsx("td",{className:s.errorCount>0?"error-count":"",children:s.errorCount}),e.jsx("td",{children:new Date(s.lastAccessed).toLocaleString()})]},r)))})]})})]}),e.jsxs("div",{className:"metrics-section",children:[e.jsx("h3",{children:"User Analytics"}),e.jsx("div",{className:"user-metrics-grid",children:l.map((s=>e.jsxs("div",{className:"user-tier-card",children:[e.jsxs("h4",{children:[s.tier.toUpperCase()," Tier"]}),e.jsxs("div",{className:"tier-stats",children:[e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-label",children:"Total Users:"}),e.jsx("span",{className:"stat-value",children:s.count})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-label",children:"Active Users:"}),e.jsx("span",{className:"stat-value",children:s.activeUsers})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-label",children:"Total Requests:"}),e.jsx("span",{className:"stat-value",children:s.totalRequests.toLocaleString()})]})]})]},s.tier)))})]}),e.jsxs("div",{className:"metrics-section",children:[e.jsx("h3",{children:"Recent Error Logs"}),e.jsx("div",{className:"error-logs",children:0===d.length?e.jsx("div",{className:"no-errors",children:"✅ No recent errors detected"}):d.map(((s,r)=>e.jsxs("div",{className:"error-log-item",children:[e.jsxs("div",{className:"error-header",children:[e.jsx("span",{className:"error-timestamp",children:new Date(s.timestamp).toLocaleString()}),e.jsx("span",{className:`error-level ${s.level}`,children:s.level})]}),e.jsx("div",{className:"error-message",children:s.message}),e.jsxs("div",{className:"error-details",children:[e.jsxs("span",{children:["Feature: ",s.feature]}),e.jsxs("span",{children:["Error ID: ",s.errorId]})]})]},r)))})]})]}):e.jsx("div",{className:"monitoring-dashboard",children:e.jsxs("div",{className:"access-denied",children:[e.jsx("h2",{children:"🔒 Access Denied"}),e.jsx("p",{children:"Administrative monitoring dashboard requires Enterprise tier access."}),e.jsxs("div",{className:"upgrade-notice",children:[e.jsx("h3",{children:"Enterprise Tier Features:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Real-time system monitoring"}),e.jsx("li",{children:"API endpoint analytics"}),e.jsx("li",{children:"User activity metrics"}),e.jsx("li",{children:"Error tracking and logs"}),e.jsx("li",{children:"Performance optimization insights"})]})]})]})});var g};export{r as default};
