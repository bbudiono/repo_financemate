import{j as e,T as s}from"./dashboard-89c4d88a.js";import{r as t}from"./react-vendor-29c1c3a2.js";const n=({userTier:n})=>{const[a,l]=t.useState(null),[i,o]=t.useState({completedNodes:[],nodeStates:{},startTime:new Date,lastUpdate:new Date}),[d,r]=t.useState(!1),[c,h]=t.useState({isDragging:!1,draggedNode:null,dragOffset:{x:0,y:0},mousePosition:{x:0,y:0}});t.useState({x:0,y:0,scale:1});const[m,p]=t.useState(null),[u,g]=t.useState(!1),[x,f]=t.useState(!1),[j,N]=t.useState({name:"",description:"",selectedAgentTypes:[]}),[v,w]=t.useState(!1),[b,y]=t.useState(null),k=t.useRef(null),C=t.useRef(null),T=s[n],A=t.useCallback(((e,s)=>{if(!u)return;e.preventDefault(),e.stopPropagation();const t=k.current?.getBoundingClientRect();t&&(h({isDragging:!0,draggedNode:s,dragOffset:{x:e.clientX-t.left-s.position.x,y:e.clientY-t.top-s.position.y},mousePosition:{x:e.clientX,y:e.clientY}}),p(s))}),[u]),D=t.useCallback((e=>{if(!c.isDragging||!c.draggedNode||!k.current)return;const s=k.current.getBoundingClientRect(),t=e.clientX-s.left-c.dragOffset.x,n=e.clientY-s.top-c.dragOffset.y;l((e=>e?{...e,nodes:e.nodes.map((e=>e.id===c.draggedNode.id?{...e,position:{x:Math.max(0,t),y:Math.max(0,n)}}:e))}:null))}),[c]),S=t.useCallback((()=>{h({isDragging:!1,draggedNode:null,dragOffset:{x:0,y:0},mousePosition:{x:0,y:0}})}),[]);t.useEffect((()=>(document.addEventListener("mousemove",D),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",S)})),[D,S]);const E=t.useCallback((async e=>{const s=e.selectedAgentTypes.filter((e=>T.allowedAgentTypes.includes(e))),t=[{id:"start",type:"start",label:"Start",config:{},position:{x:50,y:150}}],a=[];let i=250;s.forEach(((e,s)=>{const n=`agent_${s}`;t.push({id:n,type:"agent",label:`${e.charAt(0).toUpperCase()+e.slice(1)} Agent`,agentType:e,config:{agentType:e},position:{x:i,y:150}}),0===s?a.push({id:`start_to_${n}`,source:"start",target:n,label:"Initialize"}):a.push({id:`agent_${s-1}_to_${n}`,source:"agent_"+(s-1),target:n,label:"Next"}),i+=200}));t.push({id:"end",type:"end",label:"Complete",config:{},position:{x:i,y:150}}),s.length>0&&a.push({id:`agent_${s.length-1}_to_end`,source:"agent_"+(s.length-1),target:"end",label:"Finish"});const d={id:`workflow_${Date.now()}`,name:e.name,description:e.description,nodes:t,edges:a,status:"draft",userTier:n};l(d),o({completedNodes:[],nodeStates:{},startTime:new Date,lastUpdate:new Date}),f(!1),N({name:"",description:"",selectedAgentTypes:[]})}),[T,n]),U=t.useCallback((async()=>{if(!a||d)return;r(!0),l((e=>e?{...e,status:"active"}:null)),o({completedNodes:[],nodeStates:{},startTime:new Date,lastUpdate:new Date});const e=a.nodes.filter((e=>"agent"===e.type));for(let s=0;s<e.length;s++){const t=e[s];o((e=>({...e,currentNode:t.id,nodeStates:{...e.nodeStates,[t.id]:"running"},lastUpdate:new Date}))),await new Promise((e=>setTimeout(e,2e3+2e3*Math.random()))),o((e=>({...e,completedNodes:[...e.completedNodes,t.id],nodeStates:{...e.nodeStates,[t.id]:"completed"},lastUpdate:new Date})))}r(!1),l((e=>e?{...e,status:"completed"}:null)),o((e=>({...e,currentNode:void 0,lastUpdate:new Date})))}),[a,d]),_=t.useCallback((e=>{if(!a||!T.allowedAgentTypes.includes(e))return;const s={id:`agent_${Date.now()}`,type:"agent",label:`${e.charAt(0).toUpperCase()+e.slice(1)} Agent`,agentType:e,config:{agentType:e},position:{x:300+50*a.nodes.length,y:300}};l((e=>e?{...e,nodes:[...e.nodes,s]}:null))}),[a,T]),$=t.useCallback((e=>{a&&!["start","end"].includes(e)&&(l((s=>s?{...s,nodes:s.nodes.filter((s=>s.id!==e)),edges:s.edges.filter((s=>s.source!==e&&s.target!==e))}:null)),m?.id===e&&p(null))}),[a,m]),M=t.useCallback((e=>{if(v&&a)if(b){if(b!==e){const s={id:`${b}_to_${e}`,source:b,target:e,label:"Connection"};l((e=>e?{...e,edges:[...e.edges.filter((e=>e.id!==s.id)),s]}:null)),y(null),w(!1)}}else y(e)}),[v,b,a]);return e.jsxs("div",{className:"langgraph-visualizer",children:[e.jsxs("div",{className:"visualizer-header",children:[e.jsx("h2",{children:"🔀 LangGraph Workflow Designer"}),e.jsxs("div",{className:"workflow-controls",children:[e.jsx("button",{className:"control-btn primary",onClick:()=>f(!0),children:"➕ New Workflow"}),a&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"control-btn "+(u?"active":"secondary"),onClick:()=>g(!u),children:u?"✏️ Exit Edit":"✏️ Edit Mode"}),e.jsxs("button",{className:"control-btn secondary",onClick:()=>w(!v),disabled:!u,children:["🔗 ",v?"Exit Connect":"Connect Mode"]}),e.jsx("button",{className:"control-btn "+(d?"executing":"success"),onClick:U,disabled:d||"active"===a.status,children:d?"⏳ Executing...":"▶️ Execute"})]})]})]}),a?e.jsxs("div",{className:"workflow-container",children:[e.jsxs("div",{className:"workflow-canvas",ref:k,children:[e.jsxs("svg",{ref:C,className:"workflow-svg",width:"100%",height:"500",children:[a.edges.map((s=>{const t=a.nodes.find((e=>e.id===s.source)),n=a.nodes.find((e=>e.id===s.target));return t&&n?e.jsxs("g",{children:[e.jsx("line",{x1:t.position.x+75,y1:t.position.y+40,x2:n.position.x+75,y2:n.position.y+40,stroke:"#cbd5e1",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),s.label&&e.jsx("text",{x:(t.position.x+n.position.x)/2+75,y:(t.position.y+n.position.y)/2+35,textAnchor:"middle",fill:"#64748b",fontSize:"12",children:s.label})]},s.id):null})),e.jsx("defs",{children:e.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",children:e.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#cbd5e1"})})})]}),e.jsx("div",{className:"workflow-nodes",children:a.nodes.map((s=>{const t=i.completedNodes.includes(s.id),n=i.currentNode===s.id,a=m?.id===s.id;let l="#e2e8f0",o="#64748b",d="#cbd5e1";return t?(l="#10b981",o="white",d="#059669"):n?(l="#f59e0b",o="white",d="#d97706"):a&&(d="#667eea",l="#f0f9ff"),e.jsxs("div",{className:`workflow-node ${u?"editable":""} ${v?"connectable":""}`,style:{left:s.position.x,top:s.position.y,backgroundColor:l,color:o,borderColor:d,cursor:u?"move":v?"crosshair":"default"},onMouseDown:e=>A(e,s),onClick:()=>v?M(s.id):p(s),children:[e.jsxs("div",{className:"node-header",children:[e.jsx("div",{className:"node-type",children:s.type}),u&&"agent"===s.type&&e.jsx("button",{className:"delete-node-btn",onClick:e=>{e.stopPropagation(),$(s.id)},children:"✕"})]}),e.jsx("div",{className:"node-label",children:s.label}),s.agentType&&e.jsx("div",{className:"node-agent-type",children:s.agentType}),n&&e.jsx("div",{className:"node-status",children:"🔄 Running"}),t&&e.jsx("div",{className:"node-status",children:"✅ Done"}),b===s.id&&e.jsx("div",{className:"connection-indicator",children:"📌 Start"})]},s.id)}))})]}),e.jsxs("div",{className:"workflow-sidebar",children:[u&&e.jsxs("div",{className:"node-palette",children:[e.jsx("h4",{children:"🎨 Add Nodes"}),e.jsx("div",{className:"palette-nodes",children:T.allowedAgentTypes.map((s=>e.jsxs("button",{className:"palette-node-btn",onClick:()=>_(s),disabled:a.nodes.filter((e=>e.agentType===s)).length>=3,children:["research"===s?"🔍":"technical"===s?"⚙️":"creative"===s?"🎨":"financial"===s?"💰":"⚡",e.jsx("span",{children:s})]},s)))})]}),e.jsxs("div",{className:"execution-controls",children:[e.jsx("h4",{children:"🎮 Execution Status"}),e.jsxs("div",{className:"workflow-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Name:"}),e.jsx("span",{className:"info-value",children:a.name})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Status:"}),e.jsx("span",{className:`info-value status-${a.status}`,children:a.status.toUpperCase()})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Nodes:"}),e.jsx("span",{className:"info-value",children:a.nodes.length})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Progress:"}),e.jsxs("span",{className:"info-value",children:[i.completedNodes.length,"/",a.nodes.filter((e=>"agent"===e.type)).length]})]})]}),e.jsx("div",{className:"execution-progress",children:e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:i.completedNodes.length/Math.max(1,a.nodes.filter((e=>"agent"===e.type)).length)*100+"%"}})})})]}),m&&e.jsxs("div",{className:"node-details",children:[e.jsx("h4",{children:"🔍 Node Details"}),e.jsxs("div",{className:"node-detail-item",children:[e.jsx("span",{className:"detail-label",children:"ID:"}),e.jsx("span",{className:"detail-value",children:m.id})]}),e.jsxs("div",{className:"node-detail-item",children:[e.jsx("span",{className:"detail-label",children:"Type:"}),e.jsx("span",{className:"detail-value",children:m.type})]}),e.jsxs("div",{className:"node-detail-item",children:[e.jsx("span",{className:"detail-label",children:"Label:"}),e.jsx("span",{className:"detail-value",children:m.label})]}),m.agentType&&e.jsxs("div",{className:"node-detail-item",children:[e.jsx("span",{className:"detail-label",children:"Agent:"}),e.jsx("span",{className:"detail-value",children:m.agentType})]}),e.jsxs("div",{className:"node-detail-item",children:[e.jsx("span",{className:"detail-label",children:"Position:"}),e.jsxs("span",{className:"detail-value",children:["(",Math.round(m.position.x),", ",Math.round(m.position.y),")"]})]})]})]})]}):e.jsx("div",{className:"no-workflow",children:e.jsxs("div",{className:"no-workflow-content",children:[e.jsx("h3",{children:"No Workflow Created"}),e.jsx("p",{children:"Create your first interactive LangGraph workflow to coordinate AI agents."}),e.jsx("button",{className:"control-btn primary large",onClick:()=>f(!0),children:"🚀 Create Workflow"})]})}),x&&e.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:e.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"🚀 Create New Workflow"}),e.jsx("button",{className:"close-button",onClick:()=>f(!1),children:"✕"})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),E(j)},className:"workflow-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"workflowName",children:"Workflow Name *"}),e.jsx("input",{type:"text",id:"workflowName",value:j.name,onChange:e=>N((s=>({...s,name:e.target.value}))),placeholder:"e.g., Financial Analysis Pipeline",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"workflowDescription",children:"Description *"}),e.jsx("textarea",{id:"workflowDescription",value:j.description,onChange:e=>N((s=>({...s,description:e.target.value}))),placeholder:"Describe what this workflow accomplishes...",required:!0,rows:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Select Agent Types (max ",T.maxAgents,")"]}),e.jsx("div",{className:"agent-selection",children:T.allowedAgentTypes.map((s=>e.jsxs("button",{type:"button",className:"agent-toggle "+(j.selectedAgentTypes.includes(s)?"selected":""),onClick:()=>(e=>{N((s=>({...s,selectedAgentTypes:s.selectedAgentTypes.includes(e)?s.selectedAgentTypes.filter((s=>s!==e)):[...s.selectedAgentTypes,e].slice(0,T.maxAgents)})))})(s),disabled:!j.selectedAgentTypes.includes(s)&&j.selectedAgentTypes.length>=T.maxAgents,children:["research"===s?"🔍":"technical"===s?"⚙️":"creative"===s?"🎨":"financial"===s?"💰":"⚡",s.charAt(0).toUpperCase()+s.slice(1)]},s)))}),e.jsxs("small",{className:"help-text",children:["Selected: ",j.selectedAgentTypes.length,"/",T.maxAgents]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"control-btn secondary",onClick:()=>f(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"control-btn primary",disabled:!j.name.trim()||!j.description.trim()||0===j.selectedAgentTypes.length,children:"🚀 Create Workflow"})]})]})]})}),e.jsxs("div",{className:"workflow-instructions",children:[e.jsx("h4",{children:"💡 How to Use"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Create:"}),' Click "New Workflow" to start designing']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Edit:"}),' Enable "Edit Mode" to drag nodes and add connections']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Connect:"}),' Use "Connect Mode" to link nodes together']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Execute:"})," Run your workflow to see agent coordination in action"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Monitor:"})," Track real-time progress and node execution status"]})]})]}),"free"===n&&e.jsxs("div",{className:"tier-notice",children:[e.jsx("h4",{children:"🔓 Upgrade for Advanced Features"}),e.jsx("p",{children:"Upgrade to Pro for more agent types and workflow modifications, or Enterprise for unlimited workflows and advanced coordination."}),e.jsx("button",{className:"control-btn upgrade",children:"⬆️ Upgrade Now"})]})]})};export{n as default};
