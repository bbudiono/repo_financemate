#!/bin/bash

echo "üçé Apple Sign-In Configuration Script"
echo "======================================"
echo ""

# Current configuration
BUNDLE_ID="com.ablankcanvas.financemate"
TEAM_ID="7KV34995HH"

echo "üìã Current Configuration:"
echo "   Bundle ID: $BUNDLE_ID"
echo "   Team ID: $TEAM_ID"
echo ""

echo "üîß CRITICAL: Apple Sign-In Configuration Required"
echo ""
echo "The Apple Sign-In error occurs because the App ID is not properly"
echo "configured in Apple Developer Portal with Sign In with Apple capability."
echo ""

echo "üì± IMMEDIATE FIX REQUIRED:"
echo ""
echo "1. Go to: https://developer.apple.com/account/"
echo "2. Sign in with Apple ID associated with Team ID: 7KV34995HH"
echo "3. Navigate to: Certificates, Identifiers & Profiles"
echo "4. Click: Identifiers"
echo ""

echo "5. CREATE OR UPDATE APP ID:"
echo "   - If '$BUNDLE_ID' exists:"
echo "     ‚Ä¢ Click on it ‚Üí Edit ‚Üí Capabilities"
echo "     ‚Ä¢ Enable 'Sign In with Apple'"
echo "     ‚Ä¢ Configure as 'Enable as Primary App ID'"
echo "     ‚Ä¢ Save"
echo ""
echo "   - If '$BUNDLE_ID' does NOT exist:"
echo "     ‚Ä¢ Click '+' to create new App ID"
echo "     ‚Ä¢ Description: FinanceMate"
echo "     ‚Ä¢ Bundle ID: Explicit ‚Üí $BUNDLE_ID"
echo "     ‚Ä¢ Capabilities: Enable 'Sign In with Apple'"
echo "     ‚Ä¢ Configure as 'Enable as Primary App ID'"
echo "     ‚Ä¢ Register"
echo ""

echo "6. UPDATE PROVISIONING PROFILE:"
echo "   - Navigate to: Profiles"
echo "   - Find profile for FinanceMate (if exists) or create new one"
echo "   - Type: macOS App Development"
echo "   - App ID: Select the updated $BUNDLE_ID"
echo "   - Certificates: Select your development certificate"
echo "   - Generate and Download"
echo ""

echo "7. INSTALL IN XCODE:"
echo "   - Double-click downloaded provisioning profile"
echo "   - OR: Xcode ‚Üí Preferences ‚Üí Accounts ‚Üí Download Manual Profiles"
echo ""

echo "üß™ TESTING AFTER CONFIGURATION:"
echo ""
echo "After completing the above steps:"
echo "1. Clean Build (‚åò+Shift+K)"
echo "2. Build and Run"
echo "3. Test Apple Sign-In (should work without error)"
echo "4. Test Google Sign-In (should continue working)"
echo ""

echo "‚ö†Ô∏è  IMPORTANT NOTES:"
echo ""
echo "‚Ä¢ This configuration is required ONCE per Bundle ID"
echo "‚Ä¢ Changes take 10-15 minutes to propagate"
echo "‚Ä¢ You MUST have Apple Developer Program membership"
echo "‚Ä¢ Team ID 7KV34995HH must have admin privileges"
echo ""

echo "üéØ SUCCESS CRITERIA:"
echo "‚Ä¢ Apple Sign-In works without error messages"
echo "‚Ä¢ Both Apple and Google authentication functional" 
echo "‚Ä¢ Professional user experience maintained"
echo ""

echo "üìû SUPPORT:"
echo "If you encounter issues:"
echo "‚Ä¢ Verify Apple Developer Program membership is active"
echo "‚Ä¢ Ensure Bundle ID matches exactly: $BUNDLE_ID"
echo "‚Ä¢ Wait 15 minutes after changes before testing"
echo "‚Ä¢ Check Xcode signing settings match Team ID: $TEAM_ID"